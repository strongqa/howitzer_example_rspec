language: ruby
dist: trusty
sudo: required
# Bundler and ruby caching
cache:
 - bundler
 - directories:
   - "/home/travis/.rvm/"
rvm:
  - 2.6.2
apt:
  sources:
    - ubuntu-sdk-team
  packages:
    - qt5-default
    - libqt5webkit5-dev
    - gstreamer1.0-plugins-base
    - gstreamer1.0-tools
    - gstreamer1.0-x

install: bundle install --jobs=3 --retry=3 --with webkit

env:
  global:
    - ARTIFACTS_DEBUG=0
    - ARTIFACTS_REGION="eu-west-1"
    - CI_ARTIFACTS_PATH="https://s3-eu-west-1.amazonaws.com/howitzer-example-travis/$TRAVIS_REPO_SLUG/$TRAVIS_BUILD_NUMBER/$TRAVIS_JOB_NUMBER/"

  matrix:
    - secure: "k/2zzUeePe753UyPxCqCiiIwafhO19V0U4NOo1IToZUYwsGQ8L3uzzpNU8PfJDYkPYWTZBnvQNhm3gJVgvGvsVpzawmWVUHtkX+1bL8+dpVnqBjrlnR3+Du6OsLT7PtGGWOFuZDG3XDpQumI2vLq1osDZsnYB9Y+5cDY1Siu4GMY2G/jEOW5I8khufo4ubDhsY5vEmz1T+7N7G4lmyQy3Io3Jh3Ciws1Cku97ZbBT3RB+sPMlbAy40b0zZEZr0BuSogEUzfJdEt8nPQhd2nregwSkaeN9NgFVWl7nFdmBFTxr5wf86sUHH7vEd40k4uKx8BOYdtVcFAMWK/QmSXIQwO1WCHt1Fi2MloIIzGb7FkDuIS6cVbUm1GCtEArYHhX+Eti5Me/3j1hCGVtUwzNUv4PjocJ7pwy+H0DqRRwvTf77dUVVzBKMHcXmm8MMMu/AT0iTQTfl3R4JX3WgtSnxzLUAoa48K2gXWFqi81lwSG7C0lTvPG6RPF5guY+MgC1lNXVRRV5+OfnPgStwCi9/N7JLddLvmo8S8luAK8bAPcAxxQ7mX38/pQvC1BXWq7EMSJhIP6vTLz2T5foDv8vCVAg6x7H4hnbNzCu2qBIl9o55wcbIQTC0ACaEeDOdI7hHRVTluKIfMqnWr0si9k4CK45tiktZF9/bGjKQGQxH5A="
    #SEXY_SETTINGS=driver=poltergeist,mailgun_api_key=secret,mailgun_key=secret
    - secure: "IlEQm8aQCidKr752f1yGgXfv012A+M6Z8ZdeJaZ06jEvogh9j3Z9S+VIxuJbHHkdGaOiZC5MzGx9PA2xPmLtsTkqKdj11DHWXyXJ4gOyxyS7NeP1mn2o2VQ/RD+5vCx+olVFWY6ulg+AU4TnJpDjXteEDJj+rVMeHR/qeMGndWk6lCw9kBrylnZN9SW6cXpm6DaFC3hOdhk6tIXA/Y544LMf0+JbYvkFUiTmzgdmI10wzWy2VOls0hPhs5xL0VNE+F7pcXWT37zsW9wAgTjufm/eRu5JCoMrHJIg1bLUAjx4UO8z+1ysSzKqtu7HaV+IK1NGu/0WCxUwb7YGcPJm06ucnHyss6XYpgqOyLxAXX4RsiNOpavs2kuEEnodOfc38PKQ7Tq6xeHQv51dk5tiA5oK0+UGmmwaupSmxsP6A4cGf5ga2XFuZ3aPNv1r2+4DWNfzMBaxxyOEYVYGasdegQOUq33i8GBvvEFTys53ixrXBqrAAWf87n42ayQ/t7X1qUHGgZJUrJtUtIDN4sYO9KUHCFa8a9sJpye+AuCgsrIMlppBXG9JPASvB3okh5BSbW51gOyw0CnC23VTRAnrZTSlWdtWuXWceCFsYr9dCJx4JOh9BkNuRY538/dC/7YnATecRbaFkgM1LHNSyse+Iy4AieWdz10V6nh5L7FHj2Y="
    #SEXY_SETTINGS=driver=headless_chrome,mailgun_api_key=secret,mailgun_key=secret
    - secure: "Fw+moqHkGSgR8dr0KMNxMbFjoX1yL7+94AinCcH/wPrbkgeBnP5k+pmVNfCJ8kMNR/mrGY20MrqSGLFmDriHCUwh5IPdMSXOcCAgJ/9nkh34sZGdKZTbSvU4XKi69qQxbbXccmbZnapC2uD95g42zw2EUDsUDS2qRmmxjRqAQajYg7QtWeE9dXjhytttiEu+6HrCE7qhTe3UMlqD29tHnUVrnfNDI2Ev5pEPkU7ADM+G3VM1VBLuMFW4JwRThaFBvCGvOU5Y7bSxOV6bLaz9+hq7ZomWroXZzJtc7gcUqqu8w4yZrH3V0DHx3DzUsJF/qYOx/AdQqjJuFZ7kSAZNhAGS8++J1QgvPaQpQVnrBTjWgxOgGyUDKu9J6ph2pY906IlI6BDveb7N6BOdNmCpHllWC706hssdNq1zIc6LDB3uXvRaSSIVh75t+KGfGLWGWSfldyr8Ry7OE7GY28uHMEI64BV1uI2L0bxKQ4DUYCZ+nz1nr4/Hu64MnMmQ/3bqkiev9p64KdGIyBL1NvjgiMvoUVCzDZZ4ppmO/rmon+cMQEY357SmxCp5tXkU5vtBbFXOOBdPnyDWYjvSiRKTldtYDfPwMjnbDteROB8N1lm1B0Xw+gs6M43UxI4Uc5zB97PuOMjgmrZoaTsb3faadLlg3gWKXaxQGn6bsMufRpI="
    #SEXY_SETTINGS=driver=webkit,mailgun_api_key=secret,mailgun_key=secret
    - secure: "ooO86vKEPGKj3RJTXGfd4KG/KPjL5o5CIhsSrAlDKIj6gFiIgUDuRFZzH4L+NyOBGA1Di2ez1teAcr3ZMb5+J7fQj+3hV5DEuJM27wc5V7KbikkqPuq/4x975NswummDt0f6aSEWF35IF9FEV/wWV+uadaeE2MqOiJe39P2Z8/SLORQC3tdfZxskGTfTBqlf3r5Yii8g+lso58rw65GAgEUbo06SaA4fuOd4kM/PzHL4R0cAhCrLYDPrXKPRPOTurrqJKArmOeT9f2VgVRTjysq+mHlUJD/8kPLpjxiFhzSnE0+iGvxNjPZo4i1G2Vv3UYcewySI2V9pCLaftTXy0u0n552eBMuDWZqWEixhclKU657yxtFjWs2zWakwCT0lUhScVnp2iFv/DYcr2vLoCUzOmwvYk0RK6VswK5zqNvy9tJJHTUM+n9kTO6i5h/X+DEJ1XAjouf4LgGE1vP3GvKShUbqFfn3KZd0zsdiM4lcsidIJ5UUaF7eHRRFE/nYIbPbxJD/bmLhNZVi2MANvH79NovUAh3xQszunSMFsHTTOqOSsG7isdqy4vV8odOv0HSnvnJnTA/mPPfo1r06ZIcUlAbxE/8Vo4E++nbZwSWOT9QGx9RrJAO/PjyXwXMfzXRz1E6iX5L/eiRadkStFqqvg89gMzlqHRnfYoavro9E="
    #SEXY_SETTINGS=driver=sauce,mailgun_api_key=secret,mailgun_key=secret,sl_user=secret,sl_api_key=secret,cloud_auth_login=secret,cloud_auth_pass=secret
    - secure: "UjKaGlyPXF+kzIOBhmxlt4ZaBDh2Qh57FpZIjJo9ytn4b2uxxwnevsit6q+FOL3XycPVYqKHT8UBpFSVRDUKxkL9tgY8snnRO/iI+uKkn+BRSq+v8aXjfYdOGDHp/hcnNi7X94CIaQvhhjmlvFvUyGoSwm5yWthv7Hxz/xwHMmnDhQL/CFzTquRY7n9+UM+AXMNvhvmkfK/T8NyUkeksvqr3ks1ilqme3143iXXn9aCBc/1lGb8+89tgWcugfPlRXHQq0Vl+/TNVDfJViW8ZlPu2kgwu12RB2nJcLaeH4nT2tuA6KHpJzqsaCBv5qpsNCkmUnQuEUNKdysTmI1ipXHVxo93p0TJXBTa+Nf/uX5J2jSAQa3iQl+reAbTazvHdMprdm+WNd3OPQT7ExbGij239hF7FUTSFbpSHD1uSF7c0UAw5/FjOCUbaZFnRYM0lQeTJHqEOAt9GklRl+ubYW+W/zcHpj6lHu+GrE7PbxFCapzTZqAbZV8iablFsVqpb8EnMGIaIaXSRCIAmHHYxqthRi05Zy+WrfkhYsS63+aPDPVF8kRlR5TuivqyXJ7dksrgHSoa6+Na23SIoO3vAeM9x7zf1MKB5QY4lv73F1hDHMu2Kk3MOCPr3pIur9JB+vq0ZyYoiLJbphez1TNgYEMWl1+7tCnAtXArWigdWHVY="
    #SEXY_SETTINGS=driver=testingbot,mailgun_api_key=secret,mailgun_key=secret,cloud_auth_login=secret,cloud_auth_pass=secret
    - secure: "cvHnP1ZrIMpOgmyHsC8sOIsH28bOtgcZUP9K6yI4pe7UfMtQg4XX77v6n63pT+W+X+JelSd+UPgtJCFZ7boASO8uQ0mnI7sS8JfiMF1xzYakUG00z9K+3u+YY6lB8Lq9p5aIqRlDz0tDNcXBtFjTr4Awz3NohmXulXdBwJawMmLhjeTBsjGK9cvmv8QeVBQHsGdvGHOI7T/SZwAppILPaUmvEJuR4ykoTN0MF6l/+ZsxPv5KsegScKMNGGdvhrypOtZdrmujGEKL5j7xusBcOVJrJd+ehymXNx81CV1Q34nTCpBxhGKPW/0BytLTZDrknqc1T9nQAf+G7dXmTQ4+1ETuuwTemJ+yevT62V63aIpZqX38lQK0kqn82Q1XyqO5kBZ40SYchoJ/OUJGs82BVtEdLO6NYd0ZQZM1HpuMTQ3HPkrIsnJH7rn9/QFKanXLbm5gS40BllPPCZQl1OxsHGdxEXRYcDP5abBpOf+TVaVPZ3q3zIP4axtCeQO0MiJCc/y+9OM6z/21sL629H4Ql04/Krt3ycazwZ8xM9lStkA9cvT8w8PovdlxR99uZuxJ44/JLTphOJcFgj+/ixV6jThzAHY3XbFdPMGfNbAT+YH0XsUUdU1M67yd6n+/p9HXwOC7trN7gwU0DHn8Xo0RQZv5GGgcDUrCKbeUS1FnecA="
    #SEXY_SETTINGS=driver=browserstack,mailgun_api_key=secret,mailgun_key=secret,cloud_auth_login=secret,cloud_auth_pass=secret
    - secure: "ZmF9ECUM8MjXnvUu9umsikz/RyLNbMpDtvXhtc/llVevE5LqMeSUUqjm5OEAL96j5+fKb0tg8xCZIdf3j93u+VUPEsKWd33uAgsLEY/DPws3t15FbL1FyCEkxemlDQ3KGGgIopa5GRKfq3Y0Ftx78zwYfC8Fx3xfz1/Rwy0e94hKNdl3ooi25NsTfC0F+wQKkE8h09ZHadSmLIt58qh5PH34s3wb5FZekT0TN+xJYDfvXi8iRYaOk4bxR/UxXUVpTtBGQ5W/BuUQ7MlTSHg3CfdJd2rsRzDWFlQ1bFbmaPSKLhyzPY/dPUQ1sbuxd1a4aPUFBRZviRKuYL2XbBi9r1GBhuvHHImL3CELRlZqe5qONKjjjfk8rft7lBwTbEbW9Cxp/G9qN5dvsB4KZ2WC1uIrVtZKG+jCR7ZA0nzN7x4yMG06cG+um61Luhr4aI3nODWy6bRSuvzrAS8fSH3voRf68USCyfFUwN8dwGPzufZqWRFkIjgg48RdWz57ivxPZ3WZ3/vrxgFuMFCjBIToIWCcA02aDoJBC+agRlq5OKiE/KNciT2oUSEiWzEeRxKUvswDgFPAGMiDJTB7IJ84+Su779cN3AfB0hOBQb3tVNFGejoh64T3tPLuMS4tSKmY/DCpm/HFp+VaqoNxDORerlsf9iex7pr92faaSjvA1dQ="
    #SEXY_SETTINGS=driver=crossbrowsertesting,mailgun_api_key=secret,mailgun_key=secret,cloud_auth_login=secret,cloud_auth_pass=secret
    - secure: "U2WmINR6houV9p48gdrxUF8kK1o5rCWAu4aoSImcf5+hT7wSl8/NmOy5AZAu9rspPXGopev6hfwxK1QvUkTw37iPeMHXZdKXiGs0QgapRjg9nw99KSO2mC1qaGJZMeL8+CTehX3yhUL1lAgY7U7IK6gca7f9zqCN/ODMGdPh7g8HX1Y6/L0R72Z23NyejVNCDOiQZKViesRxpMQQKx03oyt5KGs3MBEf32E0ou92HsCVsHyfpm9C9bps6W4hB1f5cryhMwQPZ3097sOgmCFuWtxPVDfwg6mfb8FM+/MDKSNoYLG2xgPOPgejB3+LC/DKbSyN1YwlRsRh/8NDcdYhqce+vnVr2HmBsiVMJ+xfTrBNBbqdCx4yPtVvq+xyPu7yxqDMsILyUU15eaFt72ZAJQrwLRt4gT0CYmCmTGdw3lkXvMudtTdDubrsbHPnd3TOdgHzkD3I3KI0hMp/A+xIGWDSwMOafgMJaY27t5PZVvrJn8a9IZdB151xb6UmrqWSPX32xgcNCXnq0EwR59W/1LzW+abkZWJrDx74Bw33ruXK5vIXcr7C4A102UGlDYNRC4kVQFwAKKs92NV99pidh6HvR70zkBFoov96jjf52mqBYnxLOpio0yiqvn6N2BaSHf2/eM67T7/hEvxJf96SezxhdDbQ99hk+nZZnCxr7FE="
    #SEXY_SETTINGS=driver=headless_firefox,mailgun_api_key=secret,mailgun_key=secret


addons:
  chrome: stable
  firefox: latest
  artifacts:
    key:
      secure: "gdQTTFauwapAwLlAm6TqkbRtKWi8HXH/h/oWoElbTnOMXGOv0+KWWRh3CA85p4Qbw/7UOl/1kHSWnlu5EHEUjsOgIoArffFHAqf6/PGgQHA800O3I83sTqWKOINs0i9v8XF0Rhj9HVmjIALVsMMGztQj+P+5Pbtzyzo1CJAYqyw4hNd8z+bU3qdLMXxY1UW/xu3lFjnT36zkaak9AhnK5d5AnQUiL5hONsyntIZ9AxohS1Q8ckHln/IWsbDHeUw9wsB0AOBYncO5u3ZNhvzHdjaHIG7XDKJ3fsz55xz2cwrTNfbWYU4/fcfpeYCVE6MC4+lfZ+DmrBYlieGsYPDD/ef9AY6jV+kJtwzZ+idD6ZAxMjtZFdjf2Ya0RTaE2nFANuIpOORquAJra8csAtzVlYhp0pOTwR0YIfIFye+KSqOCzSn4V1lG+Yc4NPUn3ToO426ey9f0hz8ApNRxmIUiVq9oN6qb5gHCpLi2GWCOrJl9G5bPRHxXpLffYDUX/i15My0s6GH0UVXLaAQmw94qSkfUyBJFsg4ug5p8IHB23E6YD2N675fgvfPidn0WFJlYo/hqjZTqoWq3FoBdRsUoQWCV9fnA2Kb6Ilnw+rDQ4CJ1CLq7KjiP93rnps8V+v/hGx4hvIUC+Z8Y/u9HvHlbxLs1CtlprVPnwF1eJZncZUI="
    secret:
      secure: "YRgTCXFnt0LvpzOKB5TnZMsWLrZiu0QbKuR1op9wVQuWzKXsZMuSS6hKFJkDPXMSoKvgKREEeVRSZSjte2jJ+dpyCYCns1aWcYRYuKNntfkyZFTUBYfbinHhbZKTkYNPPsWFEoER111Wpdgn//eT1YWn1VhmFdp1exUANwM8A5v1U6iBcnOzDhYC3Jsr+2/SfiPyM1lL36bllafph00sTrnos8TivT/3XLXcjMlzHjJSQnZG4xQY2UoA4EDNSG0otM3nmPRpYrJfCj4A+yGkfNe7Qq8K3hvAY9x6KHmSb/KqXvrNga1xcvk0aQ7fIkoZukVFKRygrCp9YICf2R2dg7vMoE/2Twsto+s9R456NLiC6ib9TiOr41gPj9TqPW04BW3iynGjcLXw6A1HXMdr4XbHkprRBWwdJp0oxzfotLYTyb5pb6mT/41GDMFgMWf/La7gHg24lT/TaI80nulllz9pIpDnBIObNw4Vrd24HPThLDgJQzuD63YVGQGPzGOe4d2hB1a8SKqZiHBgBHbNQijFCxm/yJrr9LlACBG3y41NLUN28gR3LJYhgJPu5DT7Sg4/gWmnWJIGE4m1wJ3SWngVAVlxUr6OGN26k9PnmlThccJLydl3R/kOUXDMm3nQKyjMCI68AF49BrbC6GqFB4EuEDLeWrMwbdvpdN0/B/Q="
    bucket: howitzer-example-travis
    paths:
      - $(find log -type f | tr "\n" ":")

script: "./scripts/run-tests.sh"
